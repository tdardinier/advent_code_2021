fishes = []

fishes.append([[[[0,6],[8,7]],[2,3]],[3,[[6,5],[0,0]]]])
fishes.append([[2,[9,[4,9]]],[[[3,0],4],[2,[4,7]]]])
fishes.append([[[4,[5,2]],[1,[9,7]]],[[2,4],[[4,5],4]]])
fishes.append([[[[6,7],8],[[6,6],3]],[6,[7,[4,9]]]])
fishes.append([[[[5,4],[7,4]],[8,[2,3]]],[[[9,7],6],[2,[4,7]]]])
fishes.append([[[[2,4],[0,9]],6],[[[7,3],[5,9]],[0,[2,3]]]])
fishes.append([[6,[9,[2,4]]],[[3,0],[1,[0,0]]]])
fishes.append([[3,7],[3,[2,0]]])
fishes.append([[0,[2,[4,6]]],[8,9]])
fishes.append([[[7,5],[[3,8],5]],[[[9,8],[4,3]],[5,[1,4]]]])
fishes.append([[9,[[4,7],[7,1]]],[[7,[8,7]],[4,[2,6]]]])
fishes.append([[[0,4],9],[[[5,1],[3,2]],4]])
fishes.append([[[5,9],2],[8,[3,[2,4]]]])
fishes.append([[[[2,2],[9,2]],[0,7]],[[[3,7],3],0]])
fishes.append([5,[[9,1],[[6,6],9]]])
fishes.append([[5,[1,[1,7]]],[[[2,2],[5,2]],[2,0]]])
fishes.append([[[[2,0],5],[[6,1],[3,1]]],7])
fishes.append([4,[2,[3,3]]])
fishes.append([[[[8,3],[3,2]],[[4,0],3]],[[[2,5],9],4]])
fishes.append([[[6,4],[[0,8],[4,9]]],[[[7,9],7],[[5,5],[7,8]]]])
fishes.append([3,7])
fishes.append([[1,5],[[[3,7],[7,1]],[[7,4],[9,3]]]])
fishes.append([[3,[0,[4,4]]],[[3,4],[[3,1],0]]])
fishes.append([[1,[[1,1],[5,1]]],[[[8,0],5],7]])
fishes.append([[[[9,2],0],2],[8,5]])
fishes.append([4,[[0,[0,9]],[2,2]]])
fishes.append([[[4,[2,0]],[[5,5],[8,2]]],[[[5,1],[7,7]],[0,9]]])
fishes.append([[5,[[0,1],[5,9]]],[3,[8,[8,4]]]])
fishes.append([[1,9],[[3,[1,0]],[4,3]]])
fishes.append([[[1,6],[2,8]],[8,[9,3]]])
fishes.append([[[3,4],0],[4,[8,[5,8]]]])
fishes.append([[8,[9,0]],[[[6,4],[5,5]],[8,3]]])
fishes.append([[[[9,1],[3,9]],[1,[8,0]]],[[8,[8,5]],[[2,2],0]]])
fishes.append([1,[6,[6,7]]])
fishes.append([[[5,[5,8]],[[0,8],7]],[[7,6],[[7,6],[3,8]]]])
fishes.append([[8,[1,[8,6]]],[[8,4],[[3,3],1]]])
fishes.append([7,[9,[5,7]]])
fishes.append([[[8,9],[9,6]],[[[6,7],[7,4]],[2,[2,6]]]])
fishes.append([[[2,0],4],[1,[6,[6,0]]]])
fishes.append([[8,[8,[6,1]]],[[6,1],[[6,5],[2,3]]]])
fishes.append([4,[2,[[9,6],[3,5]]]])
fishes.append([6,[[3,7],[6,9]]])
fishes.append([[[[8,6],9],4],[8,[5,0]]])
fishes.append([[[[6,6],3],[7,[3,9]]],1])
fishes.append([[1,[7,5]],[[6,1],[0,[9,3]]]])
fishes.append([[[3,[6,0]],[2,5]],[[4,3],0]])
fishes.append([[[[9,2],7],[[3,7],6]],[[1,[9,1]],[[7,1],[7,7]]]])
fishes.append([[[[0,7],4],2],[5,[[2,1],3]]])
fishes.append([[[1,2],[[6,4],[8,6]]],[[[7,3],7],[[6,1],[2,1]]]])
fishes.append([[[[7,6],8],5],[[3,3],[[7,3],9]]])
fishes.append([[5,[[6,8],0]],[[6,[7,1]],2]])
fishes.append([[[4,8],[[8,2],[6,5]]],[5,[5,[8,7]]]])
fishes.append([[6,[[4,8],[5,4]]],[[[1,7],6],[6,9]]])
fishes.append([8,[8,[3,1]]])
fishes.append([[8,3],[1,[5,[0,9]]]])
fishes.append([[2,[[8,3],[5,1]]],[[2,[6,1]],[[4,0],[9,3]]]])
fishes.append([5,3])
fishes.append([[[5,3],[[1,2],[4,6]]],[[7,6],[[0,3],0]]])
fishes.append([[[6,5],8],[2,[8,3]]])
fishes.append([[[8,6],[0,5]],[[2,4],5]])
fishes.append([[[1,[4,1]],[[9,4],1]],1])
fishes.append([[[8,6],[[1,4],[9,3]]],[4,[[4,4],1]]])
fishes.append([[[2,[4,2]],[1,0]],3])
fishes.append([[0,2],[7,[7,[8,5]]]])
fishes.append([[[9,[9,5]],[0,[4,8]]],[[6,[6,7]],[[3,3],1]]])
fishes.append([1,[[[3,7],[3,2]],3]])
fishes.append([[0,[[1,6],4]],[[[2,2],[5,9]],2]])
fishes.append([[5,8],[0,9]])
fishes.append([[[[9,4],[8,8]],[[7,3],[8,1]]],[1,[7,[7,6]]]])
fishes.append([[[[7,6],[4,2]],7],[3,[[7,5],[0,9]]]])
fishes.append([[[5,6],[6,2]],[[8,6],[9,6]]])
fishes.append([[4,7],[6,9]])
fishes.append([6,[[0,[7,7]],[1,4]]])
fishes.append([[[[2,7],2],4],[[[1,8],[0,3]],3]])
fishes.append([[7,[[1,8],[0,1]]],[[3,0],[[5,0],9]]])
fishes.append([[[[1,8],[0,3]],2],[[9,5],1]])
fishes.append([[[[1,2],3],6],[3,[[8,3],[8,8]]]])
fishes.append([9,[[4,0],2]])
fishes.append([[[[8,5],6],9],[7,[9,[3,4]]]])
fishes.append([[[[5,8],[8,5]],0],6])
fishes.append([[[[0,8],[9,3]],3],[[[6,4],9],[[6,8],5]]])
fishes.append([[[[2,9],2],0],[[[9,0],[0,7]],[[6,3],[9,8]]]])
fishes.append([[[0,[0,5]],1],6])
fishes.append([[[1,[0,5]],9],[[[6,8],[7,4]],[1,[1,1]]]])
fishes.append([[[6,1],[8,6]],[[1,[0,8]],[[6,7],[1,8]]]])
fishes.append([[5,[[9,9],6]],[[0,7],[[8,2],[4,5]]]])
fishes.append([[5,4],[5,[[0,7],[5,7]]]])
fishes.append([[5,[4,8]],[[5,[0,7]],[8,6]]])
fishes.append([[[[9,5],2],[3,[9,6]]],[[6,8],[3,8]]])
fishes.append([[[[1,4],[2,9]],[2,4]],[[1,3],[[0,4],[9,9]]]])
fishes.append([[0,4],[[7,[1,4]],2]])
fishes.append([[6,4],[[[2,7],9],2]])
fishes.append([[[[9,6],6],[[4,7],[3,7]]],[[[4,8],4],[[5,2],[4,8]]]])
fishes.append([[[[8,8],0],[6,7]],[3,[0,[7,1]]]])
fishes.append([[[0,[0,3]],7],[[2,0],[6,[4,5]]]])
fishes.append([[[[0,4],5],[4,[2,6]]],[[9,9],7]])
fishes.append([1,[8,8]])
fishes.append([[[4,2],[2,[6,6]]],7])
fishes.append([7,[3,[4,[2,3]]]])
fishes.append([0,9])



# [[3,[2,[1,[7,3]]]],[6,[5,[4,[3,2]]]]]
# becomes
# [[3,[2,[8,0]]],[9,[5,[4,[3,2]]]]]

def add_leftmost(x, a):
    if isinstance(x, list):
        return [add_leftmost(x[0], a), x[1]]
    else:
        return x + a

def add_rightmost(x, a):
    if isinstance(x, list):
        return [x[0], add_rightmost(x[1], a)]
    else:
        return x + a

def explode(x, d=0):
    if isinstance(x, list):
        if d == 4:
            return (0, (x[0], x[1]))
        else:
            r = explode(x[0], d+1)
            if r[1] is None:
                r = explode(x[1], d+1)
                if r[1] is None:
                    return (x, None)
                else:
                    # Something has exploded on the RHS
                    a = x[0]
                    aa = r[1][0]
                    if aa is not None:
                        print("Before adding rightmost", a, aa)
                        a = add_rightmost(a, aa)
                        print("After adding rightmost", a)
                    return ([a, r[0]], (None, r[1][1]))
            else:
                b = x[1]
                bb = r[1][1]
                if bb is not None:
                    print("Before adding leftmost", b, bb)
                    b = add_leftmost(b, bb)
                    print("After adding leftmost", b)
                return ([r[0], b], (r[1][0], None))
    else:
        return (x, None)

def split(x):
    if isinstance(x, list):
        r = split(x[0])
        if r[1]:
            return ([r[0], x[1]], True)
        else:
            r = split(x[1])
            return ([x[0], r[0]], r[1])
    else:
        if x >= 10:
            return ([x // 2, (x + 1) // 2], True)
        else:
            return (x, False)

def reduce(x):
    has_changed = True
    while has_changed:
        has_changed = False
        (x, b) = explode(x)
        if b is None:
            (x, b) = split(x)
            has_changed = b
        else:
            has_changed = True
    return x

def add(x, y):
    return reduce([x, y])

def magnitude(x):
    if isinstance(x, list):
        return 3 * magnitude(x[0]) + 2 * magnitude(x[1])
    else:
        return x

x = fishes[0]
for y in fishes[1:]:
    x = add(x, y)

m = 0
for i in range(len(fishes)):
    for j in range(len(fishes)):
        if i != j:
            a = fishes[i]
            b = fishes[j]
            m = max(m, magnitude(add(a, b)))
            m = max(m, magnitude(add(b, a)))
print(m)
